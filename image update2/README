I tried to code according to my understanding, but I didn't test formally, so I can not guarantee it work .
But maybe it can give you inspiration^^.
